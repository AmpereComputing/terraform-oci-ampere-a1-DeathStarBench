# Cloud Init Metadata

data "template_file" "cloud_config" {
  template = file("${path.module}/templates/cloud-init.yaml.tpl")
  vars = {
    tf_ssh_privkey = tls_private_key.oci.private_key_pem
    tf_ssh_pubkey = tls_private_key.oci.public_key_openssh
    tf_random_id = random_uuid.random_id.result
    dsb_repo = var.deathstarbench_repository_url
  }
}
templatefile("${path.module}/templates/cloud-init.yaml.tpl",{ tf_ssh_privkey = tls_private_key.oci.private_key_pem, tf_ssh_pubkey = tls_private_key.oci.public_key_openssh, tf_random_id = random_uuid.random_id.result, dsb_repo = var.deathstarbench_repository_url, })


output "cloud_init" {
  value = data.template_file.cloud_config.rendered
}

templatefile("${path.module}/backends.tftpl", { port = 8080, ip_addrs = ["10.0.0.1", "10.0.0.2"] })
backend 10.0.0.1:8080
backend 10.0.0.2:8080


